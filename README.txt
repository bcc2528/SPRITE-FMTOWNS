〜〜〜〜〜〜〜〜〜〜〜FM TOWNS スプライトベンチマーク〜〜〜〜〜〜〜〜〜〜〜
作品名　：FM TOWNS スプライトベンチマーク V1.1 L20
作　者　：BCC
更新日付：2022年6月25日
種　別　：デモ・ベンチマーク
動作環境：FM TOWNS全機種(だと思う)  TownsOSはV1.1・V2.1両方で動く(はず)
動作確認：エミュレータ「津軽」(互換BIOS使用)、FM TOWNS マーティー実機
使用言語：High C コンパイラ V1.7 L12
使用方法：SP_BENCH.EXPを実行


【概要】
Oh! FM TOWNS 1991年12月号  連載記事 INSIDE TOWNS「謎のスプライト個数制限を追う」(著者：Gak McKRACKEN) p134に掲載されていた記事を参考に
・FM TOWNSのスプライト最大表示数の1024枚までのボールを画面上に表示させる
・Vsync回数を数えてフレームレートを計算・表示(不完全)
・ハイスキャンモードの他、ローレゾ・インターレースモード画面に切替
を行えるようにしたものです。
単純にFM TOWNSのスプライト機能のデモとして表示させておくのはもちろん、
使用しているFM TOWNSの1フレーム当たりの転送可能枚数、
画面モードによって転送可能枚数が変わるのかも測定することができる。


【操作方法】
パッドで操作を行います。
左右・・・スプライト表示枚数を1枚単位で変更
上下・・・スプライト表示枚数を10枚単位で変更
Aボタン・・・スプライト表示枚数を227枚に変更
Bボタン・・・画面モードの切り替え。押すたびに
31.47KHz/ノンインターレース(480p)
15.73KHz/ノンインターレース(240p)
15.73KHz/インターレース(240i)と切り替わる。
STARTボタン・・・プログラムの終了


【不具合】
・スプライト転送可能枚数がちょうど変化する枚数設定時のフレームレート表示が、
変化前のフレームレート値のまま。スプライト表示はフレームレートが低下している。
・連続でスプライト表示枚数を変更すると処理速度の問題で
フレームレート計測がかなり低い値となってしまう。
間隔をあけて少しずつ表示枚数を変更していけば問題ない。
・エミュレータ「うんづ」だと転送オーバーする枚数だと動きが長時間停止する。


【その他】
乱数の発生方法にはクロサワ式乱数を使用させていただきました。
https://groups.google.com/g/fj.sci.math/c/YJF8rsEsaA4/m/fNvnAc15U_cJ

再配布・改造などは自由に行ってください。


【参考データ】
各FM TOWNS及びTOWNSエミュレータのスプライト表示能力(ハイスキャンモード時)

実機
初期型FM TOWNSからHRまで：1フレーム/227枚
FM TOWNS マーティー 1フレーム/239枚(自分で測定)
FM TOWNS II MX/MA：1フレーム/278枚(たけがみりう氏情報)
FM TOWNS II MF/EA/Fresh系：1フレーム/284枚(たけがみりう氏情報)
FM TOWNS II HA/HB/HC：280枚(FSB33MHz)/250枚(FSB30MHz)(たけがみりう氏情報)
FMV-TOWNS(FSB66MHz)：237枚(リミッターON)/768枚(リミッターOFF、初代カード)/
785枚(リミッターOFF)(たけがみりう氏情報)

エミュレータ
津軽(v20220330)：1フレーム/293枚
うんづ(V0.5 L30 スプライト表示個数制限あり設定)：1フレーム/235枚